# 手工烤面筋小程序 - 功能说明文档

## 目录

1. [用户端功能](#用户端功能)
2. [商家端功能](#商家端功能)
3. [核心业务流程](#核心业务流程)
4. [数据模型说明](#数据模型说明)

---

## 用户端功能

### 1. 首页

#### 1.1 门店信息
- 门店名称、地址
- 营业状态（营业中/已打烊）
- 营业时间
- 配送范围

#### 1.2 特价套餐
- 展示当前启用的特价套餐
- 套餐图片、名称、描述
- 价格（原价/现价）
- 点击查看详情

#### 1.3 热销商品
- 网格展示热销商品
- 商品图片、名称、描述、价格
- 快速加入购物车

#### 1.4 新用户优惠券
- 新用户专享优惠券展示
- 一键领取功能

#### 1.5 通知中心
- 优惠券领取通知
- 显示未领取优惠券数量
- 点击领取优惠券

### 2. 商品浏览

#### 2.1 商品列表
- 分类标签切换
- 商品列表展示
- 商品搜索（预留）

#### 2.2 商品详情
- 商品图片轮播
- 商品信息（名称、描述、价格）
- 口味选择（原味、香辣、孜然等）
- 辣度选择（不辣、微辣、中辣、特辣）
- 加料选择（香菜、花生碎、芝麻等）
- 数量选择
- 加入购物车
- 立即购买

### 3. 购物车

#### 3.1 商品管理
- 商品列表展示
- 商品选择/取消选择
- 全选/取消全选
- 商品数量调整
- 删除商品
- 清空购物车

#### 3.2 配送方式
- 到店自取（配送费为0）
- 外卖配送（根据订单金额计算配送费）
- 满指定金额免配送费

#### 3.3 优惠券
- 可用优惠券列表
- 优惠券选择
- 优惠金额显示
- 支持三种类型：
  - **满减券**：满指定金额减指定金额
  - **折扣券**：按百分比折扣
  - **特定商品免单券**：购物车中有对应商品时，减免该商品价格（一张券只免一个商品）

#### 3.4 商品券
- 可用商品券列表
- 商品券选择
- 自动添加到购物车对应商品

#### 3.5 价格计算
- 商品总价
- 优惠券折扣
- 商品券折扣
- 配送费
- 最终支付金额

### 4. 订单管理

#### 4.1 订单创建
- 选择收货地址（外卖配送）
- 选择配送方式
- 选择优惠券
- 选择商品券
- 填写备注
- 创建订单

#### 4.2 订单支付
- 微信支付统一下单
- 调起微信支付
- 支付成功回调

#### 4.3 订单列表
- 按状态筛选（全部/待制作/制作中/已完成/已取消）
- 订单详情查看
- 订单操作：
  - 取消订单（待制作状态）
  - 联系商家
  - 评价订单
  - 再来一单

#### 4.4 订单详情
- 订单基本信息
- 订单商品列表
- 订单金额明细
- 配送信息
- 订单状态

### 5. 地址管理

#### 5.1 地址列表
- 显示所有收货地址
- 默认地址标识
- 地址选择（下单时）

#### 5.2 地址操作
- 新增地址
- 编辑地址
- 删除地址
- 设置默认地址

### 6. 优惠券管理

#### 6.1 优惠券列表
- 按状态分类（可用/已用/已过期）
- 优惠券详情
- 优惠券使用说明

#### 6.2 优惠券类型
- **满减券**：满指定金额减指定金额
- **折扣券**：按百分比折扣（如5折）
- **特定商品免单券**：购物车中有对应商品时，减免该商品价格

### 7. 积分商城

#### 7.1 积分余额
- 显示当前积分余额
- 积分获得说明

#### 7.2 积分商品
- 积分商品列表
- 商品信息（名称、描述、所需积分）
- 兑换限制显示：
  - 总兑换数（已兑X/Y）
  - 每人限兑次数
  - 个人已兑次数

#### 7.3 兑换功能
- 兑换优惠券（生成对应类型的优惠券）
- 兑换商品券（生成商品券）
- 积分扣除
- 兑换记录

#### 7.4 兑换状态
- **可兑换**：积分足够、有库存、未达限
- **已兑换**：已达到个人限兑次数
- **已兑完**：库存已用完
- **积分不足**：积分不够

### 8. 个人中心

#### 8.1 用户信息
- 头像、昵称
- 手机号
- 微信一键登录

#### 8.2 统计数据
- 订单数量
- 累计消费
- 积分余额

#### 8.3 功能入口
- 我的订单
- 收货地址
- 我的优惠券
- 积分商城
- 客服
- 意见反馈

---

## 商家端功能

### 1. 数据统计

#### 1.1 今日数据
- 今日订单数
- 今日营业额
- 待处理订单数

#### 1.2 数据图表
- 订单趋势
- 销售趋势
- 商品销量排行

### 2. 商品管理

#### 2.1 商品列表
- 商品列表展示
- 商品搜索
- 商品筛选（分类、状态）
- 商品状态（上架/下架）

#### 2.2 商品操作
- 新增商品
- 编辑商品
- 删除商品
- 上下架商品

#### 2.3 商品配置
- 基本信息（名称、描述、价格）
- 商品图片上传
- 口味配置
- 辣度配置
- 加料配置
- 库存管理

### 3. 分类管理

#### 3.1 分类列表
- 分类列表展示
- 分类排序

#### 3.2 分类操作
- 新增分类
- 编辑分类
- 删除分类

### 4. 门店管理

#### 4.1 门店信息
- 门店名称
- 门店地址
- 联系电话
- 营业时间
- 门店状态（营业/关闭）

#### 4.2 配送设置
- 配送范围（公里）
- 配送费
- 免配送费门槛
- 是否显示配送费

#### 4.3 位置信息
- 门店经纬度（可选）

### 5. 订单管理

#### 5.1 订单列表
- 订单列表展示
- 订单搜索
- 订单筛选（状态、时间）

#### 5.2 订单操作
- 查看订单详情
- 接单（待制作 -> 制作中）
- 完成订单（制作中 -> 已完成）
- 取消订单

#### 5.3 订单信息
- 订单基本信息
- 订单商品列表
- 订单金额
- 配送信息
- 用户信息

### 6. 特价套餐管理

#### 6.1 套餐列表
- 套餐列表展示
- 套餐状态（启用/禁用）

#### 6.2 套餐操作
- 新增套餐
- 编辑套餐
- 删除套餐
- 启用/禁用套餐

#### 6.3 套餐配置
- 套餐基本信息
- 套餐图片
- 关联商品及数量
- 套餐价格

### 7. 优惠券管理

#### 7.1 优惠券列表
- 优惠券列表展示
- 优惠券状态
- 使用统计

#### 7.2 优惠券操作
- 新增优惠券
- 编辑优惠券
- 删除优惠券
- 设置发放状态

#### 7.3 优惠券配置
- 优惠券名称、描述
- 优惠券类型（满减/折扣/特定商品免单）
- 优惠值
- 最低消费金额
- 总数量
- 过期时间
- 发放状态（是否可在通知中心领取）
- 关联商品（特定商品免单券）

### 8. 积分商城管理

#### 8.1 积分商品列表
- 积分商品列表展示
- 商品状态（启用/禁用）

#### 8.2 积分商品操作
- 新增积分商品
- 编辑积分商品
- 删除积分商品
- 启用/禁用商品

#### 8.3 积分商品配置
- 商品名称、描述
- 商品图片
- 所需积分
- 库存数量
- 每人限兑次数（-1表示无限制）
- 兑换后生成的优惠券类型：
  - 满减券：设置优惠值和最低消费
  - 折扣券：设置折扣百分比和最低消费
  - 特定商品免单券：关联商品ID

### 9. 用户管理

#### 9.1 用户列表
- 用户列表展示
- 用户搜索
- 用户详情查看

#### 9.2 用户信息
- 用户基本信息
- 订单统计
- 消费统计
- 积分统计
- 地址列表

### 10. 评论管理

#### 10.1 评论列表
- 评论列表展示
- 评论搜索
- 评论筛选

#### 10.2 评论操作
- 查看评论详情
- 删除评论
- 评论审核

---

## 核心业务流程

### 1. 用户下单流程

```
1. 浏览商品 -> 2. 加入购物车 -> 3. 选择配送方式
-> 4. 选择优惠券/商品券 -> 5. 选择收货地址（外卖）
-> 6. 创建订单 -> 7. 支付订单 -> 8. 订单完成
```

### 2. 优惠券使用流程

```
1. 领取优惠券 -> 2. 在购物车选择优惠券
-> 3. 系统计算优惠金额 -> 4. 下单时应用优惠
-> 5. 支付成功后标记优惠券为已使用
```

### 3. 积分兑换流程

```
1. 查看积分余额 -> 2. 选择积分商品
-> 3. 检查兑换条件（积分、库存、限兑次数）
-> 4. 确认兑换 -> 5. 扣除积分 -> 6. 生成优惠券/商品券
-> 7. 记录积分记录
```

### 4. 商品券使用流程

```
1. 兑换商品券 -> 2. 在购物车选择商品券
-> 3. 系统自动添加到对应商品 -> 4. 下单时应用
-> 5. 支付成功后标记商品券为已使用
```

### 5. 特定商品免单券使用流程

```
1. 兑换特定商品免单券 -> 2. 在购物车选择优惠券
-> 3. 系统检查购物车中是否有对应商品
-> 4. 计算该商品价格作为优惠金额（一张券只免一个商品）
-> 5. 下单时应用优惠 -> 6. 支付成功后标记为已使用
```

---

## 数据模型说明

### 1. 用户模型 (User)
- `openid`：微信 openid（唯一）
- `unionid`：微信 unionid
- `nickName`：昵称
- `avatarUrl`：头像
- `phone`：手机号
- `points`：积分余额
- `totalConsumption`：累计消费

### 2. 商品模型 (Product)
- `name`：商品名称
- `desc`：商品描述
- `price`：价格
- `oldPrice`：原价（可选）
- `stock`：库存
- `categoryId`：分类ID
- `images`：图片数组
- `flavors`：口味数组
- `spicyLevels`：辣度数组
- `addons`：加料数组
- `status`：状态（on_sale/off_sale）

### 3. 订单模型 (Order)
- `orderNo`：订单号
- `userId`：用户ID
- `totalPrice`：总价
- `productTotal`：商品总价
- `deliveryFee`：配送费
- `couponDiscount`：优惠券折扣
- `status`：订单状态
- `deliveryType`：配送方式
- `deliveryAddressId`：收货地址ID

### 4. 优惠券模型 (Coupon)
- `name`：优惠券名称
- `desc`：描述
- `type`：类型（reduce/discount/freeProduct）
- `value`：优惠值
- `minAmount`：最低消费
- `productId`：关联商品ID（特定商品免单券）
- `totalCount`：总数量
- `usedCount`：已使用数量
- `isDistributed`：是否发放

### 5. 积分商品模型 (PointsProduct)
- `name`：商品名称
- `desc`：描述
- `image`：图片
- `points`：所需积分
- `stock`：库存
- `usedCount`：已兑换数量
- `maxExchangePerUser`：每人限兑次数
- `couponType`：兑换后优惠券类型
- `couponValue`：优惠券优惠值
- `couponMinAmount`：优惠券最低消费
- `productId`：关联商品ID（特定商品免单券）

### 6. 商品券模型 (ProductVoucher)
- `name`：商品券名称
- `desc`：描述
- `image`：图片
- `productId`：关联商品ID
- `quantity`：商品数量
- `points`：所需积分
- `stock`：库存
- `usedCount`：已使用数量
- `maxExchangePerUser`：每人限兑次数
- `expireTime`：过期时间

### 7. 用户积分记录模型 (UserPointsRecord)
- `userId`：用户ID
- `points`：积分变化（正数为获得，负数为扣除）
- `type`：类型（earn/exchange/deduct）
- `description`：描述
- `pointsProductId`：积分商品ID（兑换时）
- `productVoucherId`：商品券ID（兑换时）
- `status`：状态（pending/completed/cancelled）

---

## 注意事项

### 1. 优惠券使用
- 特定商品免单券一张券只能免一个商品的价格
- 优惠券金额不能超过商品总价
- 特定商品免单券需要购物车中有对应商品才能使用

### 2. 积分兑换
- 兑换前检查积分余额
- 兑换前检查库存
- 兑换前检查个人限兑次数
- 兑换成功后立即扣除积分

### 3. 商品券使用
- 商品券会自动添加到购物车对应商品
- 商品券在支付成功后标记为已使用
- 商品券有过期时间

### 4. 订单支付
- 支付成功后更新订单状态
- 支付成功后标记优惠券/商品券为已使用
- 支付成功后扣除商品库存
- 支付成功后增加用户积分（消费获得积分）

---

## 版本历史

### v1.0.0
- 基础功能：商品浏览、购物车、订单、支付
- 用户登录、地址管理

### v2.0.0
- 优惠券系统
- 特价套餐
- 订单评价

### v3.0.0
- 积分商城
- 商品券系统
- 特定商品免单券
- 通知中心
