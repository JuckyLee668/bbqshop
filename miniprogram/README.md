# 手工烤面筋微信小程序

## 项目简介

手工烤面筋点餐小程序，提供完整的点餐、支付、订单管理功能。

## 技术栈

- 微信小程序原生框架
- TDesign Miniprogram 组件库
- JavaScript / TypeScript
- 微信支付

## 功能模块

### 首页
- 门店信息展示
- 特价套餐推荐
- 热销商品展示
- 新用户优惠券领取
- 通知中心（优惠券领取）

### 商品
- 商品分类浏览
- 商品列表展示
- 商品详情（口味、辣度、加料选择）
- 商品搜索

### 购物车
- 购物车商品管理
- 配送方式选择（到店自取/外卖配送）
- 优惠券选择和使用
- 商品券选择和使用
- 价格计算（含优惠券、商品券折扣）

### 订单
- 订单创建
- 订单列表（按状态筛选）
- 订单详情
- 订单支付
- 订单评价

### 个人中心
- 用户信息展示
- 订单统计
- 积分查询
- 地址管理
- 优惠券管理
- 积分商城
- 订单列表

### 积分商城
- 积分余额显示
- 积分商品列表
- 积分兑换（优惠券、商品券）
- 兑换记录查询
- 兑换限制显示

### 优惠券
- 优惠券列表（可用/已用/已过期）
- 优惠券详情
- 支持满减券、折扣券、特定商品免单券

### 地址管理
- 地址列表
- 新增/编辑地址
- 默认地址设置
- 地址删除

## 项目结构

```
miniprogram/
├── app.json              # 小程序全局配置
├── app.ts                # 小程序入口文件
├── app.wxss              # 全局样式
├── pages/                # 页面目录
│   ├── home/             # 首页
│   ├── product-list/     # 商品列表
│   ├── product-detail/   # 商品详情
│   ├── cart/             # 购物车
│   ├── order/            # 订单中心
│   ├── profile/          # 个人中心
│   ├── coupon/           # 优惠券
│   ├── points/           # 积分商城
│   ├── address/          # 地址管理
│   └── ...
├── utils/                # 工具函数
│   ├── api.js            # API 请求封装
│   ├── api-service.js    # API 服务封装
│   ├── auth.js           # 登录认证
│   └── config.js        # 配置文件
├── assets/               # 静态资源
│   └── icons/            # 图标文件
└── miniprogram_npm/      # npm 构建产物
```

## 快速开始

### 1. 环境准备

- 安装微信开发者工具
- 注册微信小程序账号
- 获取 AppID

### 2. 配置项目

1. 使用微信开发者工具打开 `miniprogram` 目录
2. 在 `project.config.json` 中配置 AppID
3. 修改 `utils/config.js` 中的 API 地址：
   ```javascript
   // 开发环境
   baseUrl: 'http://localhost:3000/v1'
   
   // 生产环境
   baseUrl: 'https://your-api-domain.com/v1'
   ```

### 3. 运行项目

1. 在微信开发者工具中点击"编译"
2. 在模拟器中预览
3. 或使用"真机调试"在手机上测试

## 配置说明

### API 地址配置

编辑 `utils/config.js`：

```javascript
const config = {
  // 开发环境
  baseUrl: 'http://localhost:3000/v1',
  
  // 生产环境（部署时修改）
  // baseUrl: 'https://your-api-domain.com/v1',
  
  timeout: 10000,
  debug: false
};
```

小程序会根据编译模式自动切换环境：
- 开发版：使用开发环境地址
- 体验版/正式版：使用生产环境地址

### 网络请求配置

在微信公众平台配置：
1. 登录微信公众平台
2. 进入"开发" -> "开发管理" -> "开发设置"
3. 在"服务器域名"中添加 API 域名
4. 配置 request 合法域名

## 核心功能说明

### 登录认证

使用微信一键登录：
1. 调用 `wx.login()` 获取 code
2. 调用后端接口进行登录
3. 保存 token 到本地存储
4. 后续请求自动携带 token

### 购物车功能

- 支持商品规格选择（口味、辣度、加料）
- 支持优惠券选择和使用
- 支持商品券选择和使用
- 自动计算最终价格

### 优惠券功能

支持三种优惠券类型：
- **满减券**：满指定金额减指定金额
- **折扣券**：按百分比折扣
- **特定商品免单券**：购物车中有对应商品时，减免该商品价格（一张券只免一个商品）

### 积分商城

- 使用积分兑换优惠券
- 使用积分兑换商品券
- 支持每人限兑次数设置
- 显示总兑换数和已兑换数

### 商品券

- 兑换后获得商品券
- 在购物车中选择使用
- 自动添加到购物车对应商品

## 开发规范

### 代码风格
- 使用 ES6+ 语法
- 变量命名：驼峰命名
- 文件命名：小写，使用连字符

### 页面结构
每个页面包含：
- `*.js` - 页面逻辑
- `*.wxml` - 页面结构
- `*.wxss` - 页面样式
- `*.json` - 页面配置

### 组件使用
- 使用 TDesign 组件库
- 在 `app.json` 中全局注册常用组件
- 在页面 `*.json` 中注册页面专用组件

## 常见问题

### 1. 网络请求失败
- 检查 API 地址配置
- 检查微信公众平台的域名配置
- 检查后端服务是否启动

### 2. 登录失败
- 检查 AppID 和 AppSecret 配置
- 检查后端登录接口
- 查看控制台错误信息

### 3. 图片不显示
- 检查图片路径
- 检查图片域名是否在微信公众平台配置
- 检查图片是否上传成功

### 4. 支付失败
- 检查微信支付配置
- 检查订单金额
- 检查支付回调地址

## 部署说明

### 开发环境
1. 配置开发环境 API 地址
2. 在微信开发者工具中编译运行

### 生产环境
1. 修改 `utils/config.js` 中的生产环境 API 地址
2. 在微信开发者工具中点击"上传"
3. 在微信公众平台提交审核
4. 审核通过后发布

## 相关文档

- [微信小程序官方文档](https://developers.weixin.qq.com/miniprogram/dev/framework/)
- [TDesign 小程序组件库](https://tdesign.tencent.com/miniprogram/overview)
- [API 设计文档](../docs/API设计文档.md)
- [项目目录说明](../docs/项目目录说明.md)
