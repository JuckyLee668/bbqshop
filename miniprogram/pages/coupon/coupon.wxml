<view class="coupon-page">
  <t-tabs value="{{activeTab}}" bind:change="onTabChange">
    <t-tab-panel label="可用" value="0">
      <view class="coupon-list">
        <view wx:if="{{availableCoupons.length > 0}}">
          <view 
            class="coupon-item available"
            wx:for="{{availableCoupons}}"
            wx:key="id"
          >
            <view class="coupon-content">
              <view class="coupon-left">
                <view class="coupon-value">
                  <text class="value-text">{{getCouponValueText(item)}}</text>
                </view>
                <view class="coupon-info">
                  <text class="coupon-name">{{item.name}}</text>
                  <text class="coupon-desc">{{item.desc || ''}}</text>
                  <text class="coupon-condition" wx:if="{{item.minAmount > 0}}">
                    满¥{{item.minAmount}}可用
                  </text>
                  <text class="coupon-condition" wx:else>
                    无门槛
                  </text>
                </view>
              </view>
              <view class="coupon-right">
                <text class="expire-text">
                  {{formatExpireTime(item.expireTime)}}
                </text>
              </view>
            </view>
          </view>
        </view>
        <t-empty wx:else description="暂无可用优惠券" />
      </view>
    </t-tab-panel>

    <t-tab-panel label="已使用" value="1">
      <view class="coupon-list">
        <view wx:if="{{usedCoupons.length > 0}}">
          <view 
            class="coupon-item used"
            wx:for="{{usedCoupons}}"
            wx:key="id"
          >
            <view class="coupon-content">
              <view class="coupon-left">
                <view class="coupon-value">
                  <text class="value-text">{{getCouponValueText(item)}}</text>
                </view>
                <view class="coupon-info">
                  <text class="coupon-name">{{item.name}}</text>
                  <text class="coupon-desc">{{item.desc || ''}}</text>
                </view>
              </view>
              <view class="coupon-right">
                <text class="status-text">已使用</text>
              </view>
            </view>
          </view>
        </view>
        <t-empty wx:else description="暂无已使用优惠券" />
      </view>
    </t-tab-panel>

    <t-tab-panel label="已过期" value="2">
      <view class="coupon-list">
        <view wx:if="{{expiredCoupons.length > 0}}">
          <view 
            class="coupon-item expired"
            wx:for="{{expiredCoupons}}"
            wx:key="id"
          >
            <view class="coupon-content">
              <view class="coupon-left">
                <view class="coupon-value">
                  <text class="value-text">{{getCouponValueText(item)}}</text>
                </view>
                <view class="coupon-info">
                  <text class="coupon-name">{{item.name}}</text>
                  <text class="coupon-desc">{{item.desc || ''}}</text>
                </view>
              </view>
              <view class="coupon-right">
                <text class="status-text">已过期</text>
              </view>
            </view>
          </view>
        </view>
        <t-empty wx:else description="暂无已过期优惠券" />
      </view>
    </t-tab-panel>
  </t-tabs>
</view>
